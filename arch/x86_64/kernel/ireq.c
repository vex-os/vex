#include <arch/idt.h>
#include <arch/ireq.h>

#include <vex/errno.h>
#include <vex/string.h>

#define IREQ_MIN 0x20
#define IREQ_MAX 0xE0

extern void x86_ireq_20(void);
extern void x86_ireq_21(void);
extern void x86_ireq_22(void);
extern void x86_ireq_23(void);
extern void x86_ireq_24(void);
extern void x86_ireq_25(void);
extern void x86_ireq_26(void);
extern void x86_ireq_27(void);
extern void x86_ireq_28(void);
extern void x86_ireq_29(void);
extern void x86_ireq_2A(void);
extern void x86_ireq_2B(void);
extern void x86_ireq_2C(void);
extern void x86_ireq_2D(void);
extern void x86_ireq_2E(void);
extern void x86_ireq_2F(void);
extern void x86_ireq_30(void);
extern void x86_ireq_31(void);
extern void x86_ireq_32(void);
extern void x86_ireq_33(void);
extern void x86_ireq_34(void);
extern void x86_ireq_35(void);
extern void x86_ireq_36(void);
extern void x86_ireq_37(void);
extern void x86_ireq_38(void);
extern void x86_ireq_39(void);
extern void x86_ireq_3A(void);
extern void x86_ireq_3B(void);
extern void x86_ireq_3C(void);
extern void x86_ireq_3D(void);
extern void x86_ireq_3E(void);
extern void x86_ireq_3F(void);
extern void x86_ireq_40(void);
extern void x86_ireq_41(void);
extern void x86_ireq_42(void);
extern void x86_ireq_43(void);
extern void x86_ireq_44(void);
extern void x86_ireq_45(void);
extern void x86_ireq_46(void);
extern void x86_ireq_47(void);
extern void x86_ireq_48(void);
extern void x86_ireq_49(void);
extern void x86_ireq_4A(void);
extern void x86_ireq_4B(void);
extern void x86_ireq_4C(void);
extern void x86_ireq_4D(void);
extern void x86_ireq_4E(void);
extern void x86_ireq_4F(void);
extern void x86_ireq_50(void);
extern void x86_ireq_51(void);
extern void x86_ireq_52(void);
extern void x86_ireq_53(void);
extern void x86_ireq_54(void);
extern void x86_ireq_55(void);
extern void x86_ireq_56(void);
extern void x86_ireq_57(void);
extern void x86_ireq_58(void);
extern void x86_ireq_59(void);
extern void x86_ireq_5A(void);
extern void x86_ireq_5B(void);
extern void x86_ireq_5C(void);
extern void x86_ireq_5D(void);
extern void x86_ireq_5E(void);
extern void x86_ireq_5F(void);
extern void x86_ireq_60(void);
extern void x86_ireq_61(void);
extern void x86_ireq_62(void);
extern void x86_ireq_63(void);
extern void x86_ireq_64(void);
extern void x86_ireq_65(void);
extern void x86_ireq_66(void);
extern void x86_ireq_67(void);
extern void x86_ireq_68(void);
extern void x86_ireq_69(void);
extern void x86_ireq_6A(void);
extern void x86_ireq_6B(void);
extern void x86_ireq_6C(void);
extern void x86_ireq_6D(void);
extern void x86_ireq_6E(void);
extern void x86_ireq_6F(void);
extern void x86_ireq_70(void);
extern void x86_ireq_71(void);
extern void x86_ireq_72(void);
extern void x86_ireq_73(void);
extern void x86_ireq_74(void);
extern void x86_ireq_75(void);
extern void x86_ireq_76(void);
extern void x86_ireq_77(void);
extern void x86_ireq_78(void);
extern void x86_ireq_79(void);
extern void x86_ireq_7A(void);
extern void x86_ireq_7B(void);
extern void x86_ireq_7C(void);
extern void x86_ireq_7D(void);
extern void x86_ireq_7E(void);
extern void x86_ireq_7F(void);
extern void x86_ireq_80(void);
extern void x86_ireq_81(void);
extern void x86_ireq_82(void);
extern void x86_ireq_83(void);
extern void x86_ireq_84(void);
extern void x86_ireq_85(void);
extern void x86_ireq_86(void);
extern void x86_ireq_87(void);
extern void x86_ireq_88(void);
extern void x86_ireq_89(void);
extern void x86_ireq_8A(void);
extern void x86_ireq_8B(void);
extern void x86_ireq_8C(void);
extern void x86_ireq_8D(void);
extern void x86_ireq_8E(void);
extern void x86_ireq_8F(void);
extern void x86_ireq_90(void);
extern void x86_ireq_91(void);
extern void x86_ireq_92(void);
extern void x86_ireq_93(void);
extern void x86_ireq_94(void);
extern void x86_ireq_95(void);
extern void x86_ireq_96(void);
extern void x86_ireq_97(void);
extern void x86_ireq_98(void);
extern void x86_ireq_99(void);
extern void x86_ireq_9A(void);
extern void x86_ireq_9B(void);
extern void x86_ireq_9C(void);
extern void x86_ireq_9D(void);
extern void x86_ireq_9E(void);
extern void x86_ireq_9F(void);
extern void x86_ireq_A0(void);
extern void x86_ireq_A1(void);
extern void x86_ireq_A2(void);
extern void x86_ireq_A3(void);
extern void x86_ireq_A4(void);
extern void x86_ireq_A5(void);
extern void x86_ireq_A6(void);
extern void x86_ireq_A7(void);
extern void x86_ireq_A8(void);
extern void x86_ireq_A9(void);
extern void x86_ireq_AA(void);
extern void x86_ireq_AB(void);
extern void x86_ireq_AC(void);
extern void x86_ireq_AD(void);
extern void x86_ireq_AE(void);
extern void x86_ireq_AF(void);
extern void x86_ireq_B0(void);
extern void x86_ireq_B1(void);
extern void x86_ireq_B2(void);
extern void x86_ireq_B3(void);
extern void x86_ireq_B4(void);
extern void x86_ireq_B5(void);
extern void x86_ireq_B6(void);
extern void x86_ireq_B7(void);
extern void x86_ireq_B8(void);
extern void x86_ireq_B9(void);
extern void x86_ireq_BA(void);
extern void x86_ireq_BB(void);
extern void x86_ireq_BC(void);
extern void x86_ireq_BD(void);
extern void x86_ireq_BE(void);
extern void x86_ireq_BF(void);
extern void x86_ireq_C0(void);
extern void x86_ireq_C1(void);
extern void x86_ireq_C2(void);
extern void x86_ireq_C3(void);
extern void x86_ireq_C4(void);
extern void x86_ireq_C5(void);
extern void x86_ireq_C6(void);
extern void x86_ireq_C7(void);
extern void x86_ireq_C8(void);
extern void x86_ireq_C9(void);
extern void x86_ireq_CA(void);
extern void x86_ireq_CB(void);
extern void x86_ireq_CC(void);
extern void x86_ireq_CD(void);
extern void x86_ireq_CE(void);
extern void x86_ireq_CF(void);
extern void x86_ireq_D0(void);
extern void x86_ireq_D1(void);
extern void x86_ireq_D2(void);
extern void x86_ireq_D3(void);
extern void x86_ireq_D4(void);
extern void x86_ireq_D5(void);
extern void x86_ireq_D6(void);
extern void x86_ireq_D7(void);
extern void x86_ireq_D8(void);
extern void x86_ireq_D9(void);
extern void x86_ireq_DA(void);
extern void x86_ireq_DB(void);
extern void x86_ireq_DC(void);
extern void x86_ireq_DD(void);
extern void x86_ireq_DE(void);
extern void x86_ireq_DF(void);
extern void x86_ireq_E0(void);
extern void x86_ireq_E1(void);
extern void x86_ireq_E2(void);
extern void x86_ireq_E3(void);
extern void x86_ireq_E4(void);
extern void x86_ireq_E5(void);
extern void x86_ireq_E6(void);
extern void x86_ireq_E7(void);
extern void x86_ireq_E8(void);
extern void x86_ireq_E9(void);
extern void x86_ireq_EA(void);
extern void x86_ireq_EB(void);
extern void x86_ireq_EC(void);
extern void x86_ireq_ED(void);
extern void x86_ireq_EE(void);
extern void x86_ireq_EF(void);
extern void x86_ireq_F0(void);
extern void x86_ireq_F1(void);
extern void x86_ireq_F2(void);
extern void x86_ireq_F3(void);
extern void x86_ireq_F4(void);
extern void x86_ireq_F5(void);
extern void x86_ireq_F6(void);
extern void x86_ireq_F7(void);
extern void x86_ireq_F8(void);
extern void x86_ireq_F9(void);
extern void x86_ireq_FA(void);
extern void x86_ireq_FB(void);
extern void x86_ireq_FC(void);
extern void x86_ireq_FD(void);
extern void x86_ireq_FE(void);
extern void x86_ireq_FF(void);

static ireq_handler_t handlers[IDT_SIZE];

void __used x86_ireq_handler(struct interrupt_frame* restrict frame, uint64_t intvec)
{
    ireq_handler_t handler;

    if((intvec >= IREQ_MIN) && (intvec < IDT_SIZE)) {
        if((handler = handlers[intvec - IREQ_MIN]) == NULL)
            return;
        handler(frame);
    }
}

int set_ireq_handler(unsigned int vector, ireq_handler_t handler)
{
    if(vector >= IREQ_MAX)
        return EINVAL;
    handlers[vector] = handler;
    return 0;
}

int unset_ireq_handler(unsigned int vector)
{
    if(vector >= IREQ_MAX)
        return EINVAL;
    handlers[vector] = NULL;
    return 0;
}

void init_ireq(void)
{
    memset(handlers, 0, sizeof(handlers));

    set_idt_entry_kern(0x20, 0, &x86_ireq_20);
    set_idt_entry_kern(0x21, 0, &x86_ireq_21);
    set_idt_entry_kern(0x22, 0, &x86_ireq_22);
    set_idt_entry_kern(0x23, 0, &x86_ireq_23);
    set_idt_entry_kern(0x24, 0, &x86_ireq_24);
    set_idt_entry_kern(0x25, 0, &x86_ireq_25);
    set_idt_entry_kern(0x26, 0, &x86_ireq_26);
    set_idt_entry_kern(0x27, 0, &x86_ireq_27);
    set_idt_entry_kern(0x28, 0, &x86_ireq_28);
    set_idt_entry_kern(0x29, 0, &x86_ireq_29);
    set_idt_entry_kern(0x2A, 0, &x86_ireq_2A);
    set_idt_entry_kern(0x2B, 0, &x86_ireq_2B);
    set_idt_entry_kern(0x2C, 0, &x86_ireq_2C);
    set_idt_entry_kern(0x2D, 0, &x86_ireq_2D);
    set_idt_entry_kern(0x2E, 0, &x86_ireq_2E);
    set_idt_entry_kern(0x2F, 0, &x86_ireq_2F);
    set_idt_entry_kern(0x30, 0, &x86_ireq_30);
    set_idt_entry_kern(0x31, 0, &x86_ireq_31);
    set_idt_entry_kern(0x32, 0, &x86_ireq_32);
    set_idt_entry_kern(0x33, 0, &x86_ireq_33);
    set_idt_entry_kern(0x34, 0, &x86_ireq_34);
    set_idt_entry_kern(0x35, 0, &x86_ireq_35);
    set_idt_entry_kern(0x36, 0, &x86_ireq_36);
    set_idt_entry_kern(0x37, 0, &x86_ireq_37);
    set_idt_entry_kern(0x38, 0, &x86_ireq_38);
    set_idt_entry_kern(0x39, 0, &x86_ireq_39);
    set_idt_entry_kern(0x3A, 0, &x86_ireq_3A);
    set_idt_entry_kern(0x3B, 0, &x86_ireq_3B);
    set_idt_entry_kern(0x3C, 0, &x86_ireq_3C);
    set_idt_entry_kern(0x3D, 0, &x86_ireq_3D);
    set_idt_entry_kern(0x3E, 0, &x86_ireq_3E);
    set_idt_entry_kern(0x3F, 0, &x86_ireq_3F);
    set_idt_entry_kern(0x40, 0, &x86_ireq_40);
    set_idt_entry_kern(0x41, 0, &x86_ireq_41);
    set_idt_entry_kern(0x42, 0, &x86_ireq_42);
    set_idt_entry_kern(0x43, 0, &x86_ireq_43);
    set_idt_entry_kern(0x44, 0, &x86_ireq_44);
    set_idt_entry_kern(0x45, 0, &x86_ireq_45);
    set_idt_entry_kern(0x46, 0, &x86_ireq_46);
    set_idt_entry_kern(0x47, 0, &x86_ireq_47);
    set_idt_entry_kern(0x48, 0, &x86_ireq_48);
    set_idt_entry_kern(0x49, 0, &x86_ireq_49);
    set_idt_entry_kern(0x4A, 0, &x86_ireq_4A);
    set_idt_entry_kern(0x4B, 0, &x86_ireq_4B);
    set_idt_entry_kern(0x4C, 0, &x86_ireq_4C);
    set_idt_entry_kern(0x4D, 0, &x86_ireq_4D);
    set_idt_entry_kern(0x4E, 0, &x86_ireq_4E);
    set_idt_entry_kern(0x4F, 0, &x86_ireq_4F);
    set_idt_entry_kern(0x50, 0, &x86_ireq_50);
    set_idt_entry_kern(0x51, 0, &x86_ireq_51);
    set_idt_entry_kern(0x52, 0, &x86_ireq_52);
    set_idt_entry_kern(0x53, 0, &x86_ireq_53);
    set_idt_entry_kern(0x54, 0, &x86_ireq_54);
    set_idt_entry_kern(0x55, 0, &x86_ireq_55);
    set_idt_entry_kern(0x56, 0, &x86_ireq_56);
    set_idt_entry_kern(0x57, 0, &x86_ireq_57);
    set_idt_entry_kern(0x58, 0, &x86_ireq_58);
    set_idt_entry_kern(0x59, 0, &x86_ireq_59);
    set_idt_entry_kern(0x5A, 0, &x86_ireq_5A);
    set_idt_entry_kern(0x5B, 0, &x86_ireq_5B);
    set_idt_entry_kern(0x5C, 0, &x86_ireq_5C);
    set_idt_entry_kern(0x5D, 0, &x86_ireq_5D);
    set_idt_entry_kern(0x5E, 0, &x86_ireq_5E);
    set_idt_entry_kern(0x5F, 0, &x86_ireq_5F);
    set_idt_entry_kern(0x60, 0, &x86_ireq_60);
    set_idt_entry_kern(0x61, 0, &x86_ireq_61);
    set_idt_entry_kern(0x62, 0, &x86_ireq_62);
    set_idt_entry_kern(0x63, 0, &x86_ireq_63);
    set_idt_entry_kern(0x64, 0, &x86_ireq_64);
    set_idt_entry_kern(0x65, 0, &x86_ireq_65);
    set_idt_entry_kern(0x66, 0, &x86_ireq_66);
    set_idt_entry_kern(0x67, 0, &x86_ireq_67);
    set_idt_entry_kern(0x68, 0, &x86_ireq_68);
    set_idt_entry_kern(0x69, 0, &x86_ireq_69);
    set_idt_entry_kern(0x6A, 0, &x86_ireq_6A);
    set_idt_entry_kern(0x6B, 0, &x86_ireq_6B);
    set_idt_entry_kern(0x6C, 0, &x86_ireq_6C);
    set_idt_entry_kern(0x6D, 0, &x86_ireq_6D);
    set_idt_entry_kern(0x6E, 0, &x86_ireq_6E);
    set_idt_entry_kern(0x6F, 0, &x86_ireq_6F);
    set_idt_entry_kern(0x70, 0, &x86_ireq_70);
    set_idt_entry_kern(0x71, 0, &x86_ireq_71);
    set_idt_entry_kern(0x72, 0, &x86_ireq_72);
    set_idt_entry_kern(0x73, 0, &x86_ireq_73);
    set_idt_entry_kern(0x74, 0, &x86_ireq_74);
    set_idt_entry_kern(0x75, 0, &x86_ireq_75);
    set_idt_entry_kern(0x76, 0, &x86_ireq_76);
    set_idt_entry_kern(0x77, 0, &x86_ireq_77);
    set_idt_entry_kern(0x78, 0, &x86_ireq_78);
    set_idt_entry_kern(0x79, 0, &x86_ireq_79);
    set_idt_entry_kern(0x7A, 0, &x86_ireq_7A);
    set_idt_entry_kern(0x7B, 0, &x86_ireq_7B);
    set_idt_entry_kern(0x7C, 0, &x86_ireq_7C);
    set_idt_entry_kern(0x7D, 0, &x86_ireq_7D);
    set_idt_entry_kern(0x7E, 0, &x86_ireq_7E);
    set_idt_entry_kern(0x7F, 0, &x86_ireq_7F);
    set_idt_entry_kern(0x80, 0, &x86_ireq_80);
    set_idt_entry_kern(0x81, 0, &x86_ireq_81);
    set_idt_entry_kern(0x82, 0, &x86_ireq_82);
    set_idt_entry_kern(0x83, 0, &x86_ireq_83);
    set_idt_entry_kern(0x84, 0, &x86_ireq_84);
    set_idt_entry_kern(0x85, 0, &x86_ireq_85);
    set_idt_entry_kern(0x86, 0, &x86_ireq_86);
    set_idt_entry_kern(0x87, 0, &x86_ireq_87);
    set_idt_entry_kern(0x88, 0, &x86_ireq_88);
    set_idt_entry_kern(0x89, 0, &x86_ireq_89);
    set_idt_entry_kern(0x8A, 0, &x86_ireq_8A);
    set_idt_entry_kern(0x8B, 0, &x86_ireq_8B);
    set_idt_entry_kern(0x8C, 0, &x86_ireq_8C);
    set_idt_entry_kern(0x8D, 0, &x86_ireq_8D);
    set_idt_entry_kern(0x8E, 0, &x86_ireq_8E);
    set_idt_entry_kern(0x8F, 0, &x86_ireq_8F);
    set_idt_entry_kern(0x90, 0, &x86_ireq_90);
    set_idt_entry_kern(0x91, 0, &x86_ireq_91);
    set_idt_entry_kern(0x92, 0, &x86_ireq_92);
    set_idt_entry_kern(0x93, 0, &x86_ireq_93);
    set_idt_entry_kern(0x94, 0, &x86_ireq_94);
    set_idt_entry_kern(0x95, 0, &x86_ireq_95);
    set_idt_entry_kern(0x96, 0, &x86_ireq_96);
    set_idt_entry_kern(0x97, 0, &x86_ireq_97);
    set_idt_entry_kern(0x98, 0, &x86_ireq_98);
    set_idt_entry_kern(0x99, 0, &x86_ireq_99);
    set_idt_entry_kern(0x9A, 0, &x86_ireq_9A);
    set_idt_entry_kern(0x9B, 0, &x86_ireq_9B);
    set_idt_entry_kern(0x9C, 0, &x86_ireq_9C);
    set_idt_entry_kern(0x9D, 0, &x86_ireq_9D);
    set_idt_entry_kern(0x9E, 0, &x86_ireq_9E);
    set_idt_entry_kern(0x9F, 0, &x86_ireq_9F);
    set_idt_entry_kern(0xA0, 0, &x86_ireq_A0);
    set_idt_entry_kern(0xA1, 0, &x86_ireq_A1);
    set_idt_entry_kern(0xA2, 0, &x86_ireq_A2);
    set_idt_entry_kern(0xA3, 0, &x86_ireq_A3);
    set_idt_entry_kern(0xA4, 0, &x86_ireq_A4);
    set_idt_entry_kern(0xA5, 0, &x86_ireq_A5);
    set_idt_entry_kern(0xA6, 0, &x86_ireq_A6);
    set_idt_entry_kern(0xA7, 0, &x86_ireq_A7);
    set_idt_entry_kern(0xA8, 0, &x86_ireq_A8);
    set_idt_entry_kern(0xA9, 0, &x86_ireq_A9);
    set_idt_entry_kern(0xAA, 0, &x86_ireq_AA);
    set_idt_entry_kern(0xAB, 0, &x86_ireq_AB);
    set_idt_entry_kern(0xAC, 0, &x86_ireq_AC);
    set_idt_entry_kern(0xAD, 0, &x86_ireq_AD);
    set_idt_entry_kern(0xAE, 0, &x86_ireq_AE);
    set_idt_entry_kern(0xAF, 0, &x86_ireq_AF);
    set_idt_entry_kern(0xB0, 0, &x86_ireq_B0);
    set_idt_entry_kern(0xB1, 0, &x86_ireq_B1);
    set_idt_entry_kern(0xB2, 0, &x86_ireq_B2);
    set_idt_entry_kern(0xB3, 0, &x86_ireq_B3);
    set_idt_entry_kern(0xB4, 0, &x86_ireq_B4);
    set_idt_entry_kern(0xB5, 0, &x86_ireq_B5);
    set_idt_entry_kern(0xB6, 0, &x86_ireq_B6);
    set_idt_entry_kern(0xB7, 0, &x86_ireq_B7);
    set_idt_entry_kern(0xB8, 0, &x86_ireq_B8);
    set_idt_entry_kern(0xB9, 0, &x86_ireq_B9);
    set_idt_entry_kern(0xBA, 0, &x86_ireq_BA);
    set_idt_entry_kern(0xBB, 0, &x86_ireq_BB);
    set_idt_entry_kern(0xBC, 0, &x86_ireq_BC);
    set_idt_entry_kern(0xBD, 0, &x86_ireq_BD);
    set_idt_entry_kern(0xBE, 0, &x86_ireq_BE);
    set_idt_entry_kern(0xBF, 0, &x86_ireq_BF);
    set_idt_entry_kern(0xC0, 0, &x86_ireq_C0);
    set_idt_entry_kern(0xC1, 0, &x86_ireq_C1);
    set_idt_entry_kern(0xC2, 0, &x86_ireq_C2);
    set_idt_entry_kern(0xC3, 0, &x86_ireq_C3);
    set_idt_entry_kern(0xC4, 0, &x86_ireq_C4);
    set_idt_entry_kern(0xC5, 0, &x86_ireq_C5);
    set_idt_entry_kern(0xC6, 0, &x86_ireq_C6);
    set_idt_entry_kern(0xC7, 0, &x86_ireq_C7);
    set_idt_entry_kern(0xC8, 0, &x86_ireq_C8);
    set_idt_entry_kern(0xC9, 0, &x86_ireq_C9);
    set_idt_entry_kern(0xCA, 0, &x86_ireq_CA);
    set_idt_entry_kern(0xCB, 0, &x86_ireq_CB);
    set_idt_entry_kern(0xCC, 0, &x86_ireq_CC);
    set_idt_entry_kern(0xCD, 0, &x86_ireq_CD);
    set_idt_entry_kern(0xCE, 0, &x86_ireq_CE);
    set_idt_entry_kern(0xCF, 0, &x86_ireq_CF);
    set_idt_entry_kern(0xD0, 0, &x86_ireq_D0);
    set_idt_entry_kern(0xD1, 0, &x86_ireq_D1);
    set_idt_entry_kern(0xD2, 0, &x86_ireq_D2);
    set_idt_entry_kern(0xD3, 0, &x86_ireq_D3);
    set_idt_entry_kern(0xD4, 0, &x86_ireq_D4);
    set_idt_entry_kern(0xD5, 0, &x86_ireq_D5);
    set_idt_entry_kern(0xD6, 0, &x86_ireq_D6);
    set_idt_entry_kern(0xD7, 0, &x86_ireq_D7);
    set_idt_entry_kern(0xD8, 0, &x86_ireq_D8);
    set_idt_entry_kern(0xD9, 0, &x86_ireq_D9);
    set_idt_entry_kern(0xDA, 0, &x86_ireq_DA);
    set_idt_entry_kern(0xDB, 0, &x86_ireq_DB);
    set_idt_entry_kern(0xDC, 0, &x86_ireq_DC);
    set_idt_entry_kern(0xDD, 0, &x86_ireq_DD);
    set_idt_entry_kern(0xDE, 0, &x86_ireq_DE);
    set_idt_entry_kern(0xDF, 0, &x86_ireq_DF);
    set_idt_entry_kern(0xE0, 0, &x86_ireq_E0);
    set_idt_entry_kern(0xE1, 0, &x86_ireq_E1);
    set_idt_entry_kern(0xE2, 0, &x86_ireq_E2);
    set_idt_entry_kern(0xE3, 0, &x86_ireq_E3);
    set_idt_entry_kern(0xE4, 0, &x86_ireq_E4);
    set_idt_entry_kern(0xE5, 0, &x86_ireq_E5);
    set_idt_entry_kern(0xE6, 0, &x86_ireq_E6);
    set_idt_entry_kern(0xE7, 0, &x86_ireq_E7);
    set_idt_entry_kern(0xE8, 0, &x86_ireq_E8);
    set_idt_entry_kern(0xE9, 0, &x86_ireq_E9);
    set_idt_entry_kern(0xEA, 0, &x86_ireq_EA);
    set_idt_entry_kern(0xEB, 0, &x86_ireq_EB);
    set_idt_entry_kern(0xEC, 0, &x86_ireq_EC);
    set_idt_entry_kern(0xED, 0, &x86_ireq_ED);
    set_idt_entry_kern(0xEE, 0, &x86_ireq_EE);
    set_idt_entry_kern(0xEF, 0, &x86_ireq_EF);
    set_idt_entry_kern(0xF0, 0, &x86_ireq_F0);
    set_idt_entry_kern(0xF1, 0, &x86_ireq_F1);
    set_idt_entry_kern(0xF2, 0, &x86_ireq_F2);
    set_idt_entry_kern(0xF3, 0, &x86_ireq_F3);
    set_idt_entry_kern(0xF4, 0, &x86_ireq_F4);
    set_idt_entry_kern(0xF5, 0, &x86_ireq_F5);
    set_idt_entry_kern(0xF6, 0, &x86_ireq_F6);
    set_idt_entry_kern(0xF7, 0, &x86_ireq_F7);
    set_idt_entry_kern(0xF8, 0, &x86_ireq_F8);
    set_idt_entry_kern(0xF9, 0, &x86_ireq_F9);
    set_idt_entry_kern(0xFA, 0, &x86_ireq_FA);
    set_idt_entry_kern(0xFB, 0, &x86_ireq_FB);
    set_idt_entry_kern(0xFC, 0, &x86_ireq_FC);
    set_idt_entry_kern(0xFD, 0, &x86_ireq_FD);
    set_idt_entry_kern(0xFE, 0, &x86_ireq_FE);
    set_idt_entry_kern(0xFF, 0, &x86_ireq_FF);
}
